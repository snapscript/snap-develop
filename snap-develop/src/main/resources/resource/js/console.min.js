define(["require","exports","./socket"],function(x,k,l){(function(e){function k(b,a){var c=document.getElementById("console");null!=c&&(c.style.fontFamily=b,c.style.fontSize=a);n=b;p=a}function q(b,a,c){h==c&&m();b=g[c];null!=b&&(b.valid=!1)}function r(){null!=document.getElementById("console")&&(document.getElementById("console").innerHTML="");h=null}function m(){var b=document.getElementById("console"),a=null,c=null;if(null!=b&&null!=h){var d=b.innerHTML,e=g[h];if(null!=e&&(""==d||1==e.update)){e.update=
!1;for(d=0;d<e.list.length;d++){var f=e.list[d];null==c?(a=f.error?"\x3cspan class\x3d'consoleError'\x3e"+f.text:"\x3cspan class\x3d'consoleNormal'\x3e"+f.text,c=f.error):f.error!=c?(a+="\x3c/span\x3e",a=f.error?a+("\x3cspan class\x3d'consoleError'\x3e"+f.text):a+("\x3cspan class\x3d'consoleNormal'\x3e"+f.text),c=f.error):a+=f.text}null!=a&&(b.innerHTML=a+"\x3c/span\x3e",b.scrollTop=b.scrollHeight)}n&&p&&k(n,p)}}function t(b){if(h!=b){var a={},c;for(c in g)if(g.hasOwnProperty(c)){var d=g[c];if(d.valid||
c==b)a[c]=d}g=a;r();h=b;m()}}function w(b,a,c){b=JSON.parse(c).process;g[b]={list:[],size:0,update:!0,valid:!0};t(b)}function u(b,a,c){var d=c.indexOf(":");b=c.substring(0,d);c=c.substring(d+1);d={error:"PRINT_ERROR"==a,text:c};a=g[b];null==a&&(a={list:[],size:0,update:!0,valid:!0},g[b]=a);a.list.push(d);for(a.size+=c.length;3<a.list.length&&a.size>v;)b=a.list.shift(),null!=b&&(a.size-=b.text.length);a.update=!0}var g={},v=5E3,h=null,n=null,p=null;e.registerConsole=function(){l.EventBus.createRoute("BEGIN",
w,null);l.EventBus.createRoute("PRINT_ERROR",u,null);l.EventBus.createRoute("PRINT_OUTPUT",u,null);l.EventBus.createRoute("TERMINATE",q,null);l.EventBus.createRoute("EXIT",q,null);setInterval(m,200)};e.updateConsoleFont=k;e.updateConsoleCapacity=function(b){v=b};e.clearConsole=r;e.showConsole=m;e.updateConsoleFocus=t})(k.ProcessConsole||(k.ProcessConsole={}))});
