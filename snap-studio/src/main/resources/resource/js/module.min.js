var ModuleSystem;
(function(q){function r(b){for(var a in g)if(g.hasOwnProperty(a)&&!b.processed[a]){var c=g[a],h=c.description;0==c.dependencies?(b.processing[a]=!1,b.processed[a]=!0,console.log("["+b.phase+"] independent module '"+a+"' ("+h+")"),b.process(c)):(b.processing[a]=!1,b.processed[a]=!1)}for(a in g)g.hasOwnProperty(a)&&(c=g[a],b.processed[a]||t(b,c))}function t(b,a){var c=a.dependencies,h=a.description,k=a.name;if(!b.processed[k]&&!b.processing[k]){b.processing[k]=!0;for(var d=0;d<c.length;d++)t(b,g[c[d]]);
console.log("["+b.phase+"] module '"+k+"' ("+h+")");b.process(a);b.processed[k]=!0}}function u(){var b={},a=[],c=[],h=[],k=[],d;for(d in g)if(g.hasOwnProperty(d)){var m=g[d],e=m.dependencies;if(null!=e)for(var n=e.length,f=0;f<n;f++){var p=e[f],l=b[p];void 0==l&&(l={name:p,modules:[]},b[p]=l);l.modules.push(m);a.push(p)}h.push(d)}for(f=0;f<a.length;f++){d=a[f];for(e=n=0;e<h.length;e++)a[f]==h[e]&&n++;0==n&&c.push(d)}for(f=0;f<c.length;f++){d=c[f];l=b[d];a="Missing dependency '"+d+"', required by ";
for(e=0;e<l.modules.length;e++)0<e&&(a+=", "),m=l.modules[e],a+="'",a+=m.name,a+="' (",a+=m.description,a+=")";k.push(a)}return k}var g={};q.registerModule=function(b,a,c,h,k){null==h&&(h=function(a){});null==c&&(c=function(a){});g[b]={name:b,description:a,prepare:c,start:h,dependencies:k}};q.loadModules=function(){var b=u();if(0<b.length)for(var a=0;a<b.length;a++)console.log(b[a]);else r({phase:"PREPARE",processed:{},processing:{},process:function(a){a.prepare&&a.prepare()}}),setTimeout(function(){r({phase:"START",
processed:{},processing:{},process:function(a){a.start&&a.start()}})},300)}})(ModuleSystem||(ModuleSystem={}));window.addEventListener("load",ModuleSystem.loadModules,!1);
